import e,{createContext as r,useContext as n,useState as t,useReducer as o,useEffect as i,useCallback as u,useMemo as a}from"react";import c from"@kinde-oss/kinde-auth-pkce-js";var s=function(){return s=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},s.apply(this,arguments)};function l(e,r,n,t){return new(n||(n=Promise))((function(o,i){function u(e){try{c(t.next(e))}catch(e){i(e)}}function a(e){try{c(t.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?o(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(u,a)}c((t=t.apply(e,r||[])).next())}))}function f(e,r){var n,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(u=0)),u;)try{if(n=1,t&&(o=2&a[0]?t.return:a[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,a[1])).done)return o;switch(t=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,t=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=r.call(e,u)}catch(e){a=[6,e],t=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g={isAuthenticated:!1,isLoading:!0},d=r(s({},g)),h=function(){var e=n(d);if(void 0===e)throw new Error("Oooops! useKindeAuth must be used within a KindeProvider");return e},v={INITIALISED:function(e,r){return s(s({},e),{isAuthenticated:Boolean(r.user),user:r.user,isLoading:!1,error:void 0})},LOGOUT:function(e){return s(s({},e),{isAuthenticated:!1,user:void 0})},ERROR:function(e,r){return s(s({},e),{isLoading:!1,error:r.error})}},p=function(e,r){return v[r.type]?v[r.type](e,r):e};var y=function(){window.history.replaceState({},document.title,window.location.pathname)},w=function(r){var n=r.audience,h=r.scope,v=r.clientId,w=r.children,b=r.domain,m=r.isDangerouslyUseLocalStorage,k=void 0!==m&&m,O=r.redirectUri,I=r.onRedirectCallback,_=void 0===I?y:I,U=r.onErrorCallback,E=r.logoutUri,F=t(),P=F[0],R=F[1],S=o(p,g),T=S[0],L=S[1];i((function(){try{l(void 0,void 0,void 0,(function(){var e;return f(this,(function(r){switch(r.label){case 0:return[4,c({audience:n,scope:h,client_id:v,domain:b,is_dangerously_use_local_storage:k,redirect_uri:O,logout_uri:E,on_redirect_callback:_,on_error_callback:U,_framework:"React",_frameworkVersion:"4.0.1"})];case 1:return e=r.sent(),R(e),[2]}}))}))}catch(e){console.error(e)}return function(){}}),[n,h,v,b,k,O,E]),i((function(){var e=!0;return function(){if(P&&e)try{var r=P.getUser();L({type:"INITIALISED",user:r})}catch(e){console.log(e),L({type:"ERROR",error:"login error"})}}(),function(){e=!1}}),[P]);var x=u((function(e){return P.login(e)}),[P]),A=u((function(e){return P.register(e)}),[P]),z=u((function(){return P.logout()}),[P]),C=u((function(e,r){return P.getClaim(e,r)}),[P]),j=u((function(e,r,n){return P.getFlag(e,r,n)}),[P]),B=u((function(e,r){return P.getBooleanFlag(e,r)}),[P]),D=u((function(e,r){return P.getIntegerFlag(e,r)}),[P]),G=u((function(e,r){return P.getStringFlag(e,r)}),[P]),K=u((function(){return P.getPermissions()}),[P]),N=u((function(e){return P.getPermission(e)}),[P]),V=u((function(){return P.getOrganization()}),[P]),q=u((function(){return P.getUserOrganizations()}),[P]),H=u((function(e){return P.createOrg(e)}),[P]),J=u((function(e){return l(void 0,void 0,void 0,(function(){var r,n;return f(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,P.getToken(e)];case 1:return r=t.sent(),[3,3];case 2:throw n=t.sent(),console.error(n);case 3:return[2,r]}}))}))}),[P]),M=u((function(e){return l(void 0,void 0,void 0,(function(){var r,n;return f(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,P.getIdToken(e)];case 1:return r=t.sent(),[3,3];case 2:throw n=t.sent(),console.error(n);case 3:return[2,r]}}))}))}),[P]),Q=u((function(){return P.getUser()}),[P]),W=a((function(){return s(s({},T),{getToken:J,getIdToken:M,login:x,register:A,logout:z,createOrg:H,getBooleanFlag:B,getClaim:C,getFlag:j,getIntegerFlag:D,getPermissions:K,getPermission:N,getOrganization:V,getStringFlag:G,getUserOrganizations:q,getUser:Q})}),[T,J,M,x,A,z,H,C,K,N,V,q,Q]);return e.createElement(d.Provider,{value:W},w)};export{w as KindeProvider,h as useKindeAuth};
//# sourceMappingURL=kinde-auth-react.esm.js.map
